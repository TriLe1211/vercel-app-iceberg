const enTranslations = {
  // Navigation
  'home': 'HOME',
  'about': 'ABOUT',
  'cooperation': 'PRODUCTS',
  'contact': 'CONTACT',
  'products':'AQUABOX',

  // Home page
  'content-intro': 'IcebergVN is part of an international group specializing in the development of water vending machine networks. Originally launched in Russia, we have expanded to multiple countries including Kazakhstan, Uzbekistan, Georgia, and now Vietnam.',
  'features-title': 'Why Choose ICEBERG VN?',
  'features-detail-1': 'Multi-stage water filtration (RO, carbon, UV)',
  'features-detail-2': 'Smart monitoring system (real-time control and diagnostics)',
  'features-detail-3': 'Easy-to-use interface with cash and cashless payment options',
  // 'features-detail-4': 'User-friendly interface',
  // 'features-detail-5': 'Support multiple payment methods',
  // 'features-detail-6': 'Detailed revenue reports',
  'partners-title': 'Our Partners',
  // About page
  // 'about_us': 'About Us',
  'about-content':'ICEBERG VN is the Vietnamese division of the international brand ICEBERG, specializing in the production and installation of automated drinking water vending stations — AquaBox.',
  'vision':'Our Vision',
  'vision-content':'Our mission is to provide people across Vietnam with affordable access to high-quality drinking water, meeting both local and international health standards.',
  'more-info-title':'VENDING MACHINE',
  'more-info-content':'The vending machines have many utilities to better serve human life. Vending machines can operate 24 hours a day which consumers can serve themselves at any time. It can help to save processing time, fulfill consumers needs and ensure safety & health for consumers. Moreover, vending machine can save space and human resources for operating sales to serve consumers.Take Box is committed to providing machine products with clear origin and ensuring food hygiene and safety. Soft drinks are kept at a stable temperature to be sure they are stored in a good condition. In addition, consumers have a variety of choices for themselves such as drinks with different types and brands, snacks, candies at affordable prices.',
  'why-aquabox':'Why choose AQUABOX?',
  'w1':'Increase the number of visitors',
  'w2':'Receive a stable income from renting out the location, without having to worry about operations and maintenance.',
  'w3':'Provide clean drinking water at a reasonable price.',
  'commitment':'OUR COMMITMENT',
  'commitment-1':'All AQUABOX devices are developed, manufactured, and maintained by ICEBERG company.',
  'process-title':'INSTALLATION PROCESS',
  'p1':'INSTALLATION',
  'p2':'TECHNICAL MAINTENANCE',
  'p3':'REPLACE FILTER',
  'free-offer':'ALL SERVICE ARE FREE',
  // Cooperation page
  'partnership': 'PARTNERSHIP',
  'partnership-text': 'The essence of Take Box is always base on user needs, integrate arious resources from different industries to provide users with quality services. Through innovation, intelligent operation, deep understanding of the market, we provide valuable services to our customers.',
  'become-a-location': 'BECOME A LOCATION',
  'become-a-location-text': 'Install vending machine in your place and become a Take Box location',
  'advertisment': 'ADVERTISMENT',
  'advertisment-text': 'Take Box commits to help advertisers reach their target accurately',
  'lease-and-franchise':'LEASE & FRANCHISE',
  'lease-and-franchise-text':'Become a Take Box partners and develop the new generation of business',
  'promotion': 'PRODUCT PROMOTION',
  'promotion-text': 'Introduce new drinks, snack and food in Take Box machine',
  'read-more':'Read More',
  // Footer
  'follow_us': 'Follow Us',
  'privacy_policy': 'Privacy Policy',
  'terms_conditions': 'Terms & Conditions',
  'address':'64 Vo Thi Sau, Tan Dinh Ward, District 1, Ho Chi Minh City ',
  'phone':'+84 368 073 966',
  'email':'vniceberg@gmail.com',
}; 

const viTranslations = {
  // Navigation
  'home': 'TRANG CHỦ',
  'about': 'GIỚI THIỆU',
  'cooperation': 'SẢN PHẨM',
  'contact': 'LIÊN HỆ',
  'products':'SẢN PHẨM CỦA ICEBERG',

  // Home page
  'content-intro': 'IcebergVN là một phần của một nhóm quốc tế chuyên phát triển mạng lưới máy bán nước. Ban đầu được ra mắt tại Nga, chúng tôi đã mở rộng đến nhiều quốc gia bao gồm Kazakhstan, Uzbekistan, Georgia và giờ là Việt Nam.',
  'features-title': 'Tại sao lại chọn ICEBERG VN?',
  'features-detail-1': 'Giá nước rẻ hơn đến 5 lần so với nước đóng chai',
  'features-detail-2': 'Kiểm soát chất lượng nghiêm ngặt và bảo trì định kỳ',
  'features-detail-3': 'ICEBERG VN đang tích cực mở rộng mạng lưới AquaBox trên toàn lãnh thổ Việt Nam.',
  'features-detail-4': 'Toàn bộ quá trình lắp đặt và bảo trì được thực hiện bởi đội ngũ ICEBERG VN chuyên nghiệp, theo tiêu chuẩn chất lượng nội bộ nghiêm ngặt.',
  // 'features-detail-5': 'Hỗ trợ nhiều phương thức thanh toán',
  // 'features-detail-6': 'Báo cáo doanh thu chi tiết',
  'partners-title': 'Đối tác của chúng tôi',
  // About page
  // 'about_us': 'Về chúng tôi',
  'about-content':'AquaBox là máy bán nước tự động với công nghệ lọc 8 bước tiên tiến giúp cung cấp nước uống sạch đảm bảo chất lượng 24/7.Thiết bị phù hợp để lắp đặt tại các khu dân cư, trường học, chợ và khu vực đông người qua lại.',
  'vision':'Tầm nhìn',
  'vision-content':'Sứ mệnh của chúng tôi là mang đến cho người dân Việt Nam nguồn nước sạch chất lượng cao với giá cả phải chăng, đạt tiêu chuẩn an toàn của Việt Nam và quốc tế.',
  'more-info-title':'Máy bán hàng tự động',
  'more-info-content':'Máy bán hàng tự động có rất nhiều tiện ích cho con người. máy hoạt động 24h trong ngày, điều đó giúp cho khách hàng có thể sử dụng bất cứ lúc nào. Bên cạnh đó giúp tiết kiệm thời gian cho khách hàng cũng như là đáp ứng đúng nhu cầu của khách với đảm bảo tốt về chất lượng và sức khỏe. Mặt khác, máy bán hàng tự động tiết kiệm không gian và không cần nhân lực để phục vụ quý khách.Chúng tôi cam kết cung cấp máy từ nguồn góc rõ ràng và đảm bảo thức ăn đồ uống vệ sinh và an toàn. Đồ uống được giữ ở một nhiệt độ ổn định và môi trường điều kiện tốt. khách hàng có nhiều sự lựa chọn về đồ ăn thức uống như thương hiệu, nhãn hiệu, giá…',
  'why-aquabox':'Tại sao lại chọn AQUABOX?',
  'w1':'Gia tăng lượng khách ghé thăm',
  'w2':'Nhận thu nhập ổn định từ việc cho thuê địa điểm, mà không cần quan tâm đến việc vận hành và bảo trì',
  'w3':'Cung cấp nước uống sạch với giá hợp lý.',
  'commitment':'CHÚNG TÔI CAM KẾT',
  'commitment-1':'Tất cả các thiết bị AQUABOX đều được phát triển, sản xuất và bảo trì bởi công ty ICEBERG.',
  'process-title':'QUY TRÌNH LẮP ĐẶT',
  'p1':'LẮP ĐẶT',
  'p2':'BẢO TRÌ KĨ THUẬT',
  'p3':'THAY LÕI LỌC',
  'free-offer':'HOÀN TOÀN MIỄN PHÍ',
   // Cooperation page
   'partnership': 'HỢP TÁC',
   'partnership-text': 'Take box luôn phục vụ dựa trên nhu cầu của khách hàng, tích hợp các nguồn lực khác nhau từ các ngành công nghiệp riêng biệt để cung cấp cho khách hàng với dịch vụ tốt nhất. Thông qua sự cải tiến, sự vận hành thông minh, am hiểu về thị trường, chúng tôi cung cấp dịch vụ giá trị cho khách hàng.',
   'become-a-location': 'TRỞ THÀNH ĐỊA ĐIỂM ĐẶT',
   'become-a-location-text': 'Lắp đặt máy bán hàng tự động tại chỗ của bạn và trở thành địa điểm của Take Box.',
   'advertisment': 'QUẢNG CÁO',
   'advertisment-text': 'Take box cam kết hỗ trợ đối tác tiếp cận được mục tiêu đối tượng chính xác.',
   'lease-and-franchise':'THUÊ VÀ NHƯỢNG QUYỀN',
   'lease-and-franchise-text':'Trở thành đối tác của Take Box và phát triển một lối kinh doanh mới',
   'promotion': 'XÚC TIẾN SẢN PHẨM',
   'promotion-text': 'Giới thiệu đồ ăn thức uống mới thông qua Take box.',
   'read-more':'Đọc thêm',

  // Footer
  'follow_us': 'Theo dõi chúng tôi',
  'privacy_policy': 'Chính sách bảo mật',
  'terms_conditions': 'Điều khoản và điều kiện',
  'address':'64 Võ Thị Sáu, Phường Tân Định, Quận 1, Thành phố Hồ Chí Minh ',
  'phone':'+84 368 073 966',
  'email':'vniceberg@gmail.com',
}; 

// Lấy ngôn ngữ từ localStorage hoặc mặc định là 'vi'
let currentLang = localStorage.getItem("language") || "vi";

// Hàm chuyển đổi ngôn ngữ
function changeLanguage(lang) {
  currentLang = lang;
  localStorage.setItem("language", lang);
  updateContent();
  updateLanguageButton();
}

// Hàm cập nhật nội dung theo ngôn ngữ
function updateContent() {
  const translations = currentLang === "vi" ? viTranslations : enTranslations;

  document.querySelectorAll("[data-translate]").forEach((element) => {
    const key = element.getAttribute("data-translate");
    if (translations[key]) {
      element.textContent = translations[key];
    }
  });
}

// Hàm cập nhật nút ngôn ngữ
function updateLanguageButton() {
  const button = document.getElementById("languageDropdown");
  if (!button) return; // Thoát nếu không tìm thấy nút

  const flag = button.querySelector("img");
  if (!flag) return; // Thoát nếu không tìm thấy hình ảnh

  // Sử dụng đường dẫn tuyệt đối
  const imgPath = "/img/";

  if (currentLang === "vi") {
    flag.src = imgPath + "vn-flag.png";
    flag.alt = "VN";
  } else {
    flag.src = imgPath + "en-flag.png";
    flag.alt = "EN";
  }
}

// Khởi tạo nội dung khi trang được load
document.addEventListener("DOMContentLoaded", () => {
  updateContent();
  updateLanguageButton();
});

// Function to check if element is in viewport
function isInViewport(element) {
  const rect = element.getBoundingClientRect();
  return (
    rect.top >= 0 &&
    rect.left >= 0 &&
    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
}

// Function to handle scroll animation
function handleScrollAnimation() {
  const elements = document.querySelectorAll('.fade-in-left, .fade-in-right, .fade-in-up');
  
  elements.forEach(element => {
    if (isInViewport(element)) {
      element.classList.add('animate');
    }
  });
}

// Add scroll event listener
window.addEventListener('scroll', handleScrollAnimation);
// Check on initial load
window.addEventListener('load', handleScrollAnimation);

// Function to include HTML components
async function includeHTML(elementId, path) {
  try {
    const response = await fetch(path);
    const html = await response.text();
    document.getElementById(elementId).innerHTML = html;
    
    // Initialize language after loading navbar
    if (elementId === 'navbar-container') {
      const currentLang = localStorage.getItem('language') || 'vi';
      changeLanguage(currentLang);
    }
    return true;
  } catch (error) {
    console.error('Error loading component:', error);
    return false;
  }
}

// Load navbar and footer
document.addEventListener('DOMContentLoaded', function() {
    // Load navbar
    fetch('pages/navbar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('navbar-container').innerHTML = data;
            // Initialize language after loading navbar
            const currentLang = localStorage.getItem('language') || 'vi';
            changeLanguage(currentLang);
            // Set active nav link immediately after navbar is loaded
            setActiveNavLink();
        })
        .catch(error => console.error('Error loading navbar:', error));

    // Load footer
    fetch('pages/footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer-container').innerHTML = data;
            // Apply translations after loading footer
            const currentLang = localStorage.getItem('language') || 'vi';
            changeLanguage(currentLang);
        })
        .catch(error => console.error('Error loading footer:', error));
});

// Add active class to current page link
function setActiveNavLink() {
    const currentPage = window.location.pathname.split('/').pop() || 'home.html';
    const navLinks = document.querySelectorAll('.nav-link');
    
    // List of cooperation dropdown pages
    const cooperationPages = [
        'become-a-location.html',
        'advertise.html',
        'leasing-franchise.html',
        'product-promotion.html'
    ];
    
    navLinks.forEach(link => {
        // Remove any existing active styles
        link.classList.remove('active');
        link.style.borderTop = 'none';
        
        // Get the href value and extract the page name
        const href = link.getAttribute('href');
        const pageName = href.split('/').pop();
        
        // Check if this is the current page or a cooperation dropdown page
        if (pageName === currentPage || 
            (currentPage === '' && pageName === 'home.html') ||
            (currentPage === 'index.html' && pageName === 'home.html') ||
            (cooperationPages.includes(currentPage) && pageName === 'cooperation.html')) {
            link.classList.add('active');
            link.style.borderTop = '3px solid var(--primary-color)';
        }
    });
}

// Also call setActiveNavLink when URL changes
window.addEventListener('popstate', setActiveNavLink);

// Animation Observer
const animationObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('animate');
    }
  });
}, {
  threshold: 0.1
});

// Observe elements for animation
document.addEventListener('DOMContentLoaded', function() {
  // Contact page animations
  const contactElements = document.querySelectorAll('.contact-text, .contact-img, .map-container, .contact-detail');
  contactElements.forEach(element => {
    animationObserver.observe(element);
  });
});